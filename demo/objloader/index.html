<html>
	<head></head>
	<script src="/index.js"></script>
	<script src="../orbitControl.js"></script>

	<body style="">
		<!-- <svg width="500" height="500">
			<path stroke="red"  d="M100 250 C0 100 500 100 400 250"></path>
			<path stroke="blue"  d="M100 250 L0 200 L500 200 L400 250" fill="transparent"> </path>
		</svg> -->
	</body>
	
	<script>
		const {OBJLoader,MTLLoader} = window.TNTVLayers;
		let model;
		//测试函数
		function main(){
			const loader = new OBJLoader();
			
			new MTLLoader().load("./test.mtl",(materials)=>{
				materials.materials.default = new THREE.MeshPhysicalMaterial( {
					color: new THREE.Color().setHSL( 0.5, 0.5, 0.25 ),
					metalness:0.9,
					roughness: 0.5,
					clearcoat: 1 ,
					clearcoatRoughness: 0.1 ,
					// reflectivity: 0.7,
				} );
				materials.preload();
				new OBJLoader().setMaterials( materials ).load('./test.obj',
					function ( object ) {
						// object.scale.set(0.05,0.05,0.05);
						object.children.map(item=>{
							item.receiveShadow = true;

							item.castShadow = true;
							object.children.map(item=>{
								item.castShadow = true;
							})
						});
						scene.add( object );
					},
				);
			});
		}
		
		 

		var scene = new THREE.Scene();
		var camera = new THREE.PerspectiveCamera( 90, window.innerWidth/window.innerHeight, 0.1, 10000 );
	
		var renderer = new THREE.WebGLRenderer({antialias :true,alpha:true});
		renderer.setSize( window.innerWidth, window.innerHeight );
		renderer.shadowMap.enabled = true;
		renderer.shadowMap.type = THREE.PCFSoftShadowMap;
		renderer.outputEncoding = THREE.sRGBEncoding;
		renderer.toneMapping = THREE.ACESFilmicToneMapping;
		renderer.toneMappingExposure = 1.25;
		document.body.appendChild( renderer.domElement );

		
		var controls = new THREE.OrbitControls( camera, renderer.domElement );
		// controls.autoRotate = true;
		controls.minDistance = 1;
		controls.maxPolarAngle = Math.PI*0.95/2;
		camera.position.set( 30, 30, 50 );
		controls.update();
		controls.autoRotate = true;
	
		// var axesHelper = new THREE.AxesHelper( 3.75*2+3.5 );
		// scene.add( axesHelper );
		var directionalLight = new THREE.DirectionalLight( 0xfafefa, 0.6 );
		directionalLight.position.set(50,50,50);
		directionalLight.castShadow = true;
		directionalLight.shadow.camera.far = 2000;
		var d = 50;
		directionalLight.shadow.mapSize.width = 2048;
		directionalLight.shadow.mapSize.height = 2048;
		directionalLight.shadow.camera.left = - d;
		directionalLight.shadow.camera.right = d;
		directionalLight.shadow.camera.top = d;
		directionalLight.shadow.camera.bottom = - d;

		scene.add( directionalLight );

		var light = new THREE.AmbientLight( 0xffffff,1 ); // soft white light
		scene.add( light );

		// scene.background = new THREE.Color( 0xcce0ff );
		// scene.fog = new THREE.Fog( 0xffffff, 50, 1000 );
		
		// const plane = new THREE.Mesh(new THREE.PlaneGeometry(10000,10000),new THREE.MeshLambertMaterial({color:"#555665"}))
		// plane.rotation.x = -Math.PI/2;
		// plane.position.z = -0.15;
		// plane.receiveShadow = true;
		// scene.add(plane)

		var animate = function () {
			requestAnimationFrame( animate );
			controls.update();
			// directionalLight.position.copy(camera.position)
			renderer.render( scene, camera );
			
		};
		main();

		animate();

	</script>
</html>